<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sistema de Cadastro</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 400px; margin: 20px auto; }
  label { display: block; margin-top: 10px; }
  input { width: 100%; padding: 8px; margin-top: 5px; }
  .error { color: red; font-size: 0.9em; margin-top: 2px; }
  .success { color: green; font-weight: bold; margin-top: 10px; }
  button { margin-top: 15px; padding: 10px 15px; }
</style>
</head>
<body>

<h2>Cadastro de Usuário</h2>

<form id="cadastroForm" novalidate>
  <label for="nome">Nome:
    <input type="text" id="nome" name="nome" />
    <div class="error" id="errorNome"></div>
  </label>

  <label for="usuario">Usuário:
    <input type="text" id="usuario" name="usuario" />
    <div class="error" id="errorUsuario"></div>
  </label>

  <label for="senha">Senha:
    <input type="password" id="senha" name="senha" />
    <div class="error" id="errorSenha"></div>
  </label>

  <label for="email">Email:
    <input type="email" id="email" name="email" />
    <div class="error" id="errorEmail"></div>
  </label>

  <label for="dataNascimento">Data de Nascimento:
    <input type="date" id="dataNascimento" name="dataNascimento" />
    <div class="error" id="errorDataNascimento"></div>
  </label>

  <button type="submit">Cadastrar</button>
</form>

<div id="mensagemSucesso" class="success"></div>

<script>
  const form = document.getElementById('cadastroForm');
  const mensagemSucesso = document.getElementById('mensagemSucesso');

  function limparErros() {
    ['Nome', 'Usuario', 'Senha', 'Email', 'DataNascimento'].forEach(campo => {
      document.getElementById(`error${campo}`).innerText = '';
    });
    mensagemSucesso.innerText = '';
  }

  function validarFormulario(dados) {
    if (!dados.nome.trim()) {
      throw { campo: 'Nome', mensagem: 'O campo Nome é obrigatório.' };
    }
    if (!dados.usuario.trim()) {
      throw { campo: 'Usuario', mensagem: 'O campo Usuário é obrigatório.' };
    }
    if (!dados.senha) {
      throw { campo: 'Senha', mensagem: 'O campo Senha é obrigatório.' };
    } else if (dados.senha.length < 6) {
      throw { campo: 'Senha', mensagem: 'A senha deve ter pelo menos 6 caracteres.' };
    }
    if (!dados.email.trim()) {
      throw { campo: 'Email', mensagem: 'O campo Email é obrigatório.' };
    } else {
      const regexEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!regexEmail.test(dados.email)) {
        throw { campo: 'Email', mensagem: 'Formato de email inválido.' };
      }
    }
    if (!dados.dataNascimento) {
      throw { campo: 'DataNascimento', mensagem: 'O campo Data de Nascimento é obrigatório.' };
    } else {
      const hoje = new Date();
      const nascimento = new Date(dados.dataNascimento);
      let idade = hoje.getFullYear() - nascimento.getFullYear();
      const mes = hoje.getMonth() - nascimento.getMonth();
      if (mes < 0 || (mes === 0 && hoje.getDate() < nascimento.getDate())) {
        idade--;
      }
      if (idade < 18) {
        throw { campo: 'DataNascimento', mensagem: 'O usuário deve ter pelo menos 18 anos.' };
      }
    }
  }

  form.addEventListener('submit', e => {
    e.preventDefault();
    limparErros();

    const dados = {
      nome: form.nome.value,
      usuario: form.usuario.value,
      senha: form.senha.value,
      email: form.email.value,
      dataNascimento: form.dataNascimento.value,
    };

    try {
      validarFormulario(dados);
      mensagemSucesso.innerText = 'Cadastro realizado com sucesso!';
      form.reset();
    } catch (error) {
      if (error.campo && error.mensagem) {
        document.getElementById(`error${error.campo}`).innerText = error.mensagem;
      } else {
        alert('Ocorreu um erro inesperado: ' + error);
      }
    }
  });
</script>

</body>
</html>
